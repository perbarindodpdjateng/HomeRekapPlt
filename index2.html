<!doctype html><meta charset="utf-8"><meta name="viewport" content="width=device-width"><title>Rekap</title>
<style>
body{margin:0;font:12px/1.4 system-ui;background:#fff;color:#111}
input{width:100%;padding:6px;border:1px solid #bbb;border-radius:3px}
table{width:100%;border-collapse:collapse}
th{position:sticky;top:0;background:#005288;color:#fff;text-align:left;padding:4px 6px;font-weight:600}
td{padding:4px 6px;border-bottom:1px solid #e5e5e5}
tbody tr:nth-child(even) td{background:#f2f6fa}
tr:hover td{background:#d0e7ff}
</style>
<input id=q placeholder="Cariâ€¦">
<table id=t></table>
<script>
const URL='https://script.google.com/macros/s/AKfycbxoZvhFliYUB10gTxlxXl7CBd5_35gqDzOIJBpfRioNOpS3uAdlcYXjP6qGbO9sm6qP5g/exec';
let d=[];
async function load(){
  const r=await fetch(URL,{cache:'no-store'}).then(x=>x.json());
  if(JSON.stringify(r)!=JSON.stringify(d)){d=r;render(d);}
}
function render(a){
  t.innerHTML=a.map((r,i)=>`<tr>${
    r.map((c,j)=>{
      if(!i)return`<th>${c}</th>`;
      if(!j&&typeof r[2]=='string'&&r[2].startsWith('http'))return`<td><a href="${r[2]}" target=_blank>${c}</a></td>`;
      if(j==0||j==4)c=new Date(c);if(c instanceof Date)c=`${(c.getDate()+'').padStart(2,0)}/${(c.getMonth()+1+'').padStart(2,0)}/${c.getFullYear()%100}`;
      return`<td>${c}</td>`
    }).join``
  }</tr>`).join``;
}
q.oninput=e=>{
  const k=e.target.value.trim().toLowerCase();
  render(k?d.filter((r,i)=>!i||r.some(x=>(''+x).toLowerCase().includes(k))):d);
};
addEventListener('visibilitychange',()=>!document.hidden&&load());
load();
</script>
